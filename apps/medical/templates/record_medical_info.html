{% extends "base.html" %}
{% block main %}
    <div id="login" class="row">
        <div class="col-md-4 col-md-offset-4">
            <h1>Record Medical Information <br/> (for Doctor)</h1>
            <hr/>
            <form class="form-horizontal" name="RegisterForm" action="/add_medical_record/{{ patient_id }}/" method="post">
                {% csrf_token %}
                {% if next %}
                    <input type="hidden" name="next" value="{{ next }}" />
                {% endif %}
                <div class="form-group">
                    <label class="control-label" for="patient_id">Patient ID</label>
                    <input type="text" class="form-control" id="patient_id" name="patient_id" 
                        value="{{ patient_id }}" disabled="">
                </div>
                <div class="form-group">
                    <label class="control-label" for="officer_id">Doctor ID</label>
                    <input type="text" class="form-control" id="officer_id" name="officer_id" 
                        value="{{ doctor_id }}" disabled="">
                </div>
                <div class="form-group">
                    <label class="control-label" for="symptom">Symptom</label>
                    <textarea class="form-control" id="symptom" name="symptom" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label class="control-label" for="diagnosis">Diagnosis</label>
                    <textarea class="form-control" id="diagnosis" name="diagnosis" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label class="control-label" for="drg_code">DRG Code</label>
                    <select class="form-control" id="drg_code" name="drg_code" >
                        {% for drg_code in drg_codes %}
                        <option value="{{ drg_code.id }}">{{ drg_code.description }}</option>
                        {% endfor %}
                    </select>
                </div>
                <hr/>

                <div class="form-group">
                    <label class="control-label" for="drug_name">Drug Name (optional)</label>
                    <select class="form-control" id="drug_name" name="drug_name" >
                        {% for drug_item in drug_list %}
                        <option value="{{ drug_item.id }}">{{ drug_item.description }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label class="control-label" for="drug_dose">Drug Dose (optional)</label>
                    <input type="number" class="form-control" id="drug_dose" name="drug_dose" value="0">
                </div>
                <div class="form-group">
                    <button type="button" class="btn btn-default" id="add-drug-btn">Add Drug</button>
                </div>
                <div class="form-group">
                    <label class="control-label" for="drug_list">Drug List (optional)</label>
                    <input type="text" class="form-control" id="drug_list" name="drug_list" readonly="">
                </div>

                <hr/>
                <div class="form-group">
                    <button type="submit" class="btn btn-default">Save</button>
                </div>
            </form>
        </div>
    </div>
{% endblock %}

{% block script %}
<script type="text/javascript">
$("#add-drug-btn").click(function(){
    var drug_name = $("#drug_name").val();
    var drug_dose = $("#drug_dose").val();
    var drug_item = drug_name + ':' + drug_dose;

    var old_val = $("#drug_list").val();
    if( old_val == '' ) {
        $("#drug_list").val(old_val + drug_item);
    } else {
        $("#drug_list").val(old_val + ',' + drug_item);
    }

    $("#drug_name").val(0);
    $("#drug_dose").val(0);
});
</script>
{% endblock %}